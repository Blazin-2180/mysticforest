[gd_scene load_steps=8 format=3 uid="uid://du1s5vcrfmcju"]

[ext_resource type="Texture2D" uid="uid://7u1tpnlr0ho6" path="res://GUI/Sprites/SidePanel.png" id="1_hnjqb"]
[ext_resource type="Texture2D" uid="uid://doxp5pfvb3mja" path="res://GUI/Sprites/Panel.png" id="2_w00hm"]
[ext_resource type="PackedScene" uid="uid://bx3h406wgpg83" path="res://GUI/Inventory/Stats/stats.tscn" id="3_7c088"]
[ext_resource type="Texture2D" uid="uid://dyc6o5fjjpch2" path="res://GUI/Sprites/Close_Button.png" id="5_ue6d2"]
[ext_resource type="PackedScene" uid="uid://cuv6ed6yntyvs" path="res://GUI/Inventory/inventory_slot.tscn" id="6_tmfq0"]

[sub_resource type="GDScript" id="GDScript_h787y"]
resource_name = "character"
script/source = "extends CanvasLayer

#region /// Variables
var character_show : bool = false
#endregion

#region /// On Ready Variables
@onready var inventory_slot: Button = $Control/TabContainer/Inventory/Panel/GridContainer/InventorySlot
@onready var item_description: Label = $Control/TabContainer/Inventory/ItemDescription	
@onready var audio_stream : AudioStreamPlayer = $AudioStreamPlayer
@onready var name_label: Label = $Control/Label
#endregion

#region /// Signals
signal shown
signal hidden
signal preview_stats_changed ( item : ItemData )
#endregion

func _ready() -> void:
	hide_character()
	pass

func _unhandled_input ( event : InputEvent ) -> void:
	if event.is_action_pressed( \"character\" ) || event.is_action_pressed( \"ui_cancel\" ):
		if character_show == false :
			if DialogSystem.is_active:
				return
			show_character()
		else : 
			hide_character()
			get_viewport().set_input_as_handled()

func show_character () -> void :
	visible = true
	character_show = true
	name_label.text = GlobalPlayerManager.character_name
	shown.emit()


func hide_character () -> void : 
	visible = false
	character_show = false
	hidden.emit()


func update_item_description (new_text : String) -> void :
	item_description.text = new_text


func focus_item_changed( slot : SlotData ) -> void : 
	if slot : 
		if slot.item_data :
			update_item_description( slot.item_data.description )
			preview_stats( slot.item_data )
	else : 
		update_item_description(\"\")
		preview_stats( null )
	pass


func _on_load_pressed () -> void :
	GlobalSaveManager.load_game()
	await GlobalLevelManager.level_load_started
	hide_character()
	pass



func play_audio( audio : AudioStream ) -> void :
	audio_stream.stream = audio
	audio_stream.play()
	pass


func preview_stats( item : ItemData) -> void : 
	preview_stats_changed.emit( item )
	pass


func _on_button_pressed() -> void:
	Character.hide()
	pass # Replace with function body.
"

[sub_resource type="StyleBoxTexture" id="StyleBoxTexture_2cw0n"]
content_margin_left = 32.0
content_margin_top = 32.0
content_margin_right = 32.0
content_margin_bottom = 32.0
texture_margin_left = 32.0
texture_margin_top = 32.0
texture_margin_right = 32.0
texture_margin_bottom = 32.0

[node name="Character" type="CanvasLayer"]
process_mode = 3
layer = 2
script = SubResource("GDScript_h787y")

[node name="Control" type="Control" parent="."]
process_mode = 3
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
mouse_behavior_recursive = 1

[node name="SidePanel" type="TextureRect" parent="Control"]
y_sort_enabled = true
layout_mode = 1
anchors_preset = 11
anchor_left = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -1019.0
offset_top = 139.0
offset_right = -817.0
offset_bottom = -173.27014
grow_horizontal = 0
grow_vertical = 2
texture = ExtResource("1_hnjqb")
expand_mode = 1

[node name="ColorRect" type="TextureRect" parent="Control"]
layout_mode = 1
anchors_preset = 11
anchor_left = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -856.0
offset_top = 133.0
offset_right = -534.0
offset_bottom = -165.27014
grow_horizontal = 0
grow_vertical = 2
texture = ExtResource("2_w00hm")
expand_mode = 1

[node name="Label" type="Label" parent="Control"]
layout_mode = 1
anchors_preset = -1
anchor_left = 0.45700002
anchor_top = 0.187
anchor_right = 0.45700002
anchor_bottom = 0.187
offset_left = -88.96002
offset_top = 16.36
offset_right = 89.03998
offset_bottom = 37.36
theme_override_colors/font_color = Color(1, 0.7227015, 0.41414726, 1)
theme_override_font_sizes/font_size = 16
horizontal_alignment = 1

[node name="Stats" parent="Control" instance=ExtResource("3_7c088")]
layout_mode = 0
offset_left = 305.0
offset_top = 158.0
offset_right = 405.0
offset_bottom = 242.0
mouse_filter = 1

[node name="EquipmentPanel" type="PanelContainer" parent="Control"]
layout_mode = 1
anchors_preset = -1
anchor_left = 0.45400003
anchor_top = 0.5
anchor_right = 0.45400003
anchor_bottom = 0.5
offset_left = -132.12006
offset_top = -205.0
offset_right = 131.87994
offset_bottom = 195.0
mouse_filter = 1
theme_override_styles/panel = SubResource("StyleBoxTexture_2cw0n")
metadata/_edit_use_anchors_ = true

[node name="GridContainer" type="GridContainer" parent="Control/EquipmentPanel"]
layout_mode = 2
columns = 5

[node name="VBoxContainer" type="VBoxContainer" parent="Control/EquipmentPanel/GridContainer"]
layout_mode = 2

[node name="HBoxContainer" type="HBoxContainer" parent="Control/EquipmentPanel/GridContainer/VBoxContainer"]
layout_mode = 2

[node name="Spacer" parent="Control/EquipmentPanel/GridContainer/VBoxContainer/HBoxContainer" instance=ExtResource("6_tmfq0")]
modulate = Color(1, 1, 1, 0)
layout_mode = 2
focus_mode = 1
mouse_filter = 2
disabled = true

[node name="HeadSlot" parent="Control/EquipmentPanel/GridContainer/VBoxContainer/HBoxContainer" instance=ExtResource("6_tmfq0")]
unique_name_in_owner = true
layout_mode = 2
focus_mode = 1
mouse_filter = 2

[node name="Spacer2" parent="Control/EquipmentPanel/GridContainer/VBoxContainer/HBoxContainer" instance=ExtResource("6_tmfq0")]
modulate = Color(1, 1, 1, 0)
layout_mode = 2
focus_mode = 1
mouse_filter = 2
disabled = true

[node name="HBoxContainer2" type="HBoxContainer" parent="Control/EquipmentPanel/GridContainer/VBoxContainer"]
layout_mode = 2

[node name="ShoulderSlot" parent="Control/EquipmentPanel/GridContainer/VBoxContainer/HBoxContainer2" instance=ExtResource("6_tmfq0")]
unique_name_in_owner = true
layout_mode = 2
focus_neighbor_top = NodePath("../../HBoxContainer/HeadSlot")

[node name="NeckSlot" parent="Control/EquipmentPanel/GridContainer/VBoxContainer/HBoxContainer2" instance=ExtResource("6_tmfq0")]
unique_name_in_owner = true
layout_mode = 2
focus_neighbor_top = NodePath("../../HBoxContainer/HeadSlot")

[node name="BackSlot" parent="Control/EquipmentPanel/GridContainer/VBoxContainer/HBoxContainer2" instance=ExtResource("6_tmfq0")]
unique_name_in_owner = true
layout_mode = 2
focus_neighbor_top = NodePath("../../HBoxContainer/HeadSlot")

[node name="HBoxContainer3" type="HBoxContainer" parent="Control/EquipmentPanel/GridContainer/VBoxContainer"]
layout_mode = 2

[node name="HandSlot" parent="Control/EquipmentPanel/GridContainer/VBoxContainer/HBoxContainer3" instance=ExtResource("6_tmfq0")]
unique_name_in_owner = true
layout_mode = 2

[node name="ChestSlot" parent="Control/EquipmentPanel/GridContainer/VBoxContainer/HBoxContainer3" instance=ExtResource("6_tmfq0")]
unique_name_in_owner = true
layout_mode = 2

[node name="Ring1Slot" parent="Control/EquipmentPanel/GridContainer/VBoxContainer/HBoxContainer3" instance=ExtResource("6_tmfq0")]
unique_name_in_owner = true
layout_mode = 2

[node name="HBoxContainer4" type="HBoxContainer" parent="Control/EquipmentPanel/GridContainer/VBoxContainer"]
layout_mode = 2

[node name="Spacer2" parent="Control/EquipmentPanel/GridContainer/VBoxContainer/HBoxContainer4" instance=ExtResource("6_tmfq0")]
modulate = Color(1, 1, 1, 0)
layout_mode = 2
focus_mode = 1
mouse_filter = 2
disabled = true

[node name="LegSlot" parent="Control/EquipmentPanel/GridContainer/VBoxContainer/HBoxContainer4" instance=ExtResource("6_tmfq0")]
unique_name_in_owner = true
layout_mode = 2

[node name="Ring2Slot" parent="Control/EquipmentPanel/GridContainer/VBoxContainer/HBoxContainer4" instance=ExtResource("6_tmfq0")]
unique_name_in_owner = true
layout_mode = 2

[node name="HBoxContainer5" type="HBoxContainer" parent="Control/EquipmentPanel/GridContainer/VBoxContainer"]
layout_mode = 2

[node name="MainHandSlot" parent="Control/EquipmentPanel/GridContainer/VBoxContainer/HBoxContainer5" instance=ExtResource("6_tmfq0")]
unique_name_in_owner = true
layout_mode = 2

[node name="FeetSlot" parent="Control/EquipmentPanel/GridContainer/VBoxContainer/HBoxContainer5" instance=ExtResource("6_tmfq0")]
unique_name_in_owner = true
layout_mode = 2

[node name="OffHandSlot" parent="Control/EquipmentPanel/GridContainer/VBoxContainer/HBoxContainer5" instance=ExtResource("6_tmfq0")]
unique_name_in_owner = true
layout_mode = 2

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="."]
max_polyphony = 4
bus = &"SFX"

[node name="Button" type="Button" parent="."]
offset_left = 718.6042
offset_top = 144.66283
offset_right = 753.6042
offset_bottom = 179.66283
rotation = -0.8652173
icon = ExtResource("5_ue6d2")
flat = true
icon_alignment = 1

[connection signal="pressed" from="Button" to="." method="_on_button_pressed"]
